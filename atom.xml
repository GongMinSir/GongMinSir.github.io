<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MyLife</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-11-03T09:24:37.122Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Gong Min</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>静态LACP模式链路聚合</title>
    <link href="http://yoursite.com/2017/11/03/LACP%E9%93%BE%E8%B7%AF%E8%81%9A%E5%90%88/"/>
    <id>http://yoursite.com/2017/11/03/LACP链路聚合/</id>
    <published>2017-11-03T09:23:10.000Z</published>
    <updated>2017-11-03T09:24:37.122Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/155OdXx.png" alt=""></p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><h3 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h3><pre><code>[S1]interface Eth-Trunk 1 [S1-Eth-Trunk1]mode lacp-static [S1-Eth-Trunk1]quit    [S1]interface GigabitEthernet 0/0/9 [S1-GigabitEthernet0/0/9]eth-trunk 1 [S1-GigabitEthernet0/0/9]quit [S1]interface GigabitEthernet 0/0/10 [S1-GigabitEthernet0/0/10]eth-trunk 1 [S1]lacp  priority 100 [S1]interface GigabitEthernet 0/0/9 [S1-GigabitEthernet0/0/9]lacp priority 100 [S1-GigabitEthernet0/0/9]quit [S1]interface GigabitEthernet 0/0/10 [S1-GigabitEthernet0/0/10]lacp priority 100</code></pre><h3 id="S2"><a href="#S2" class="headerlink" title="S2"></a>S2</h3><pre><code>[S2]interface Eth-Trunk 1 [S2-Eth-Trunk1]mode lacp-static [S2-Eth-Trunk1]quit [S2]interface GigabitEthernet 0/0/9 [S2-GigabitEthernet0/0/9]eth-trunk 1 [S2-GigabitEthernet0/0/9]interface GigabitEthernet 0/0/10 [S2-GigabitEthernet0/0/10]eth-trunk 1</code></pre>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/155OdXx.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=
      
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="华为" scheme="http://yoursite.com/tags/%E5%8D%8E%E4%B8%BA/"/>
    
  </entry>
  
  <entry>
    <title>华为防火墙之用户上网NAT和服务器负载均衡</title>
    <link href="http://yoursite.com/2017/10/30/%E9%98%B2%E7%81%AB%E5%A2%99%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE1%E2%80%94%E2%80%94%E7%94%A8%E6%88%B7%E4%B8%8A%E7%BD%91NAT%E5%92%8C%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1/"/>
    <id>http://yoursite.com/2017/10/30/防火墙基础配置1——用户上网NAT和服务器负载均衡/</id>
    <published>2017-10-30T10:23:10.000Z</published>
    <updated>2017-10-30T11:23:03.580Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/Pkh57x6.png" alt=""><br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="实验目的"><a href="#实验目的" class="headerlink" title="实验目的"></a>实验目的</h2><p>①掌握基础安全区域的配置。<br>②掌握基础域间策略的配置。<br>③掌握nat easy-ip的配置。<br>④掌握nat server的配置。<br>⑤掌握服务器负载均衡。</p><h2 id="实验需求"><a href="#实验需求" class="headerlink" title="实验需求"></a>实验需求</h2><p>①配置trust区域用户可以上网，client3拒绝ping，所有trust区域主机拒绝telnet外网。<br>②192.168.200.200主机nat到外网，可以使用公网IP 211.1.1.100访问。<br>③主机192.168.200.201 202 203提供负载均衡服务，虚拟服务地址211.1.1.200。</p><h2 id="实验配置"><a href="#实验配置" class="headerlink" title="实验配置"></a>实验配置</h2><pre><code>&lt;SRG&gt;sys[SRG]stp region-configuration[SRG-mst-region]region-name e054e31560b5[SRG-mst-region]active region-configuration[SRG]interface GigabitEthernet0/0/0[SRG-GigabitEthernet0/0/0]alias GE0/MGMT[SRG-GigabitEthernet0/0/0] ip address 192.168.100.1 255.255.255.0Info: The DHCP server configuration on this interface will be deleted.[SRG-GigabitEthernet0/0/0]dhcp select interface[SRG-GigabitEthernet0/0/0]dhcp server gateway-list 192.168.100.1[SRG-GigabitEthernet0/0/0]dhcp server dns-list 8.8.8.8[SRG]interface GigabitEthernet0/0/1[SRG-GigabitEthernet0/0/1]ip address 192.168.200.1 255.255.255.0[SRG]interface GigabitEthernet0/0/2[SRG-GigabitEthernet0/0/2]ip address 211.1.1.1 255.255.255.0[SRG]firewall zone untrust[SRG-zone-untrust]add interface GigabitEthernet0/0/2[SRG-zone-untrust]firewall zone dmz[SRG-zone-dmz]add interface GigabitEthernet0/0/1[SRG-zone-dmz]firewall zone name usr1[SRG-zone-usr1]set priority 86[SRG-zone-usr1]add interface GigabitEthernet0/0/8[SRG]slb[SRG-slb]rserver 1 rip 192.168.200.201 weight 32 healthchk[SRG-slb]rserver 2 rip 192.168.200.202 weight 32 healthchk[SRG-slb]rserver 3 rip 192.168.200.203 weight 32 healthchk[SRG-slb]group g1[SRG-slb-group-g1]metric roundrobin[SRG-slb-group-g1]addrserver 1[SRG-slb-group-g1]addrserver 2[SRG-slb-group-g1]addrserver 3[SRG-slb-group-g1]vserver ser1 vip 211.1.1.200 group g1[SRG]firewall packet-filter default permit interzone local untrust direction inbound[SRG]firewall packet-filter default permit interzone local dmz direction inbound[SRG]firewall packet-filter default permit interzone dmz untrust direction outbound[SRG]nat address-group 0 mypool 211.1.1.10 211.1.1.20[SRG]nat server 0 global 211.1.1.100 inside 192.168.200.200[SRG]slb enable[SRG]policy interzone trust untrust outbound[SRG-policy-interzone-trust-untrust-outbound]policy 1[SRG-policy-interzone-trust-untrust-outbound-1]action deny[SRG-policy-interzone-trust-untrust-outbound-1]policy service service-set icmp[SRG-policy-interzone-trust-untrust-outbound-1]policy source 192.168.100.100 0[SRG-policy-interzone-trust-untrust-outbound-1]policy 5[SRG-policy-interzone-trust-untrust-outbound-5]action deny[SRG-policy-interzone-trust-untrust-outbound-5]policy service service-set telnet[SRG-policy-interzone-trust-untrust-outbound-5]policy source 192.168.100.0 mask 24[SRG-policy-interzone-trust-untrust-outbound-5]policy 10[SRG-policy-interzone-trust-untrust-outbound-10]action permit[SRG-policy-interzone-trust-untrust-outbound-10]policy source 192.168.100.0 mask 24[SRG]policy interzone dmz untrust inbound[SRG-policy-interzone-dmz-untrust-inbound]policy 10[SRG-policy-interzone-dmz-untrust-inbound-10]action permit[SRG-policy-interzone-dmz-untrust-inbound-10]policy destination 192.168.200.200 0[SRG-policy-interzone-dmz-untrust-inbound-10]policy destination 192.168.200.0 mask 24[SRG]nat-policy interzone trust untrust outbound[SRG-nat-policy-interzone-trust-untrust-outbound] policy 10[SRG-nat-policy-interzone-trust-untrust-outbound-10]action source-nat[SRG-nat-policy-interzone-trust-untrust-outbound-10]policy source 192.168.100.0 mask 24[SRG-nat-policy-interzone-trust-untrust-outbound-10]easy-ip GigabitEthernet0/0/2</code></pre><h2 id="实验验证"><a href="#实验验证" class="headerlink" title="实验验证"></a>实验验证</h2><p>主机4ping公网：<br><img src="https://i.imgur.com/FcIPQny.png" alt=""></p><p>主机3ping公网：<br><img src="https://i.imgur.com/OCzIe5b.png" alt=""></p><p>公网ping NAT服务器192.168.100.200：<br><img src="https://i.imgur.com/6mm44jz.png" alt=""></p><p>此时防火墙会话列表：<br><img src="https://i.imgur.com/5l6QadE.png" alt=""></p><p>公网ping负载均衡服务器公网地址：<br><img src="https://i.imgur.com/SDOlra8.png" alt=""></p><p>此时防火墙会话列表：<br><img src="https://i.imgur.com/ZwxXLOW.png" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/Pkh57x6.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="HUAWEI" scheme="http://yoursite.com/tags/HUAWEI/"/>
    
  </entry>
  
  <entry>
    <title>igraph分析网络</title>
    <link href="http://yoursite.com/2017/10/20/igraph%E7%94%BB%E5%9B%BE/"/>
    <id>http://yoursite.com/2017/10/20/igraph画图/</id>
    <published>2017-10-20T06:23:10.000Z</published>
    <updated>2017-12-11T11:48:07.766Z</updated>
    
    <content type="html"><![CDATA[<h2 id="软件包的安装"><a href="#软件包的安装" class="headerlink" title="软件包的安装"></a>软件包的安装</h2><h3 id="python的安装"><a href="#python的安装" class="headerlink" title="python的安装"></a>python的安装</h3><h4 id="下载地址"><a href="#下载地址" class="headerlink" title="下载地址"></a>下载地址</h4><a id="more"></a><p><the rest="" of="" contents="" |="" 余下全文=""><br>    <a href="https://www.python.org/downloads/windows/" target="_blank" rel="external">https://www.python.org/downloads/windows/</a><br>    从中选一个3以后的版本下载安装</the></p><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><pre><code>打开文件安装，安装完成之后配置环境变量，在path中添加python安装的目录和Scripts比如我的：</code></pre><p><img src="https://i.imgur.com/j4gtBfv.jpg" alt=""></p><h4 id="调试python"><a href="#调试python" class="headerlink" title="调试python"></a>调试python</h4><pre><code>打开cmd输入python会出下如下则安装成功：</code></pre><p><img src="https://i.imgur.com/yDPmqU4.jpg" alt=""></p><h3 id="setuptools安装"><a href="#setuptools安装" class="headerlink" title="setuptools安装"></a>setuptools安装</h3><p>####　下载地址<br>    <a href="https://pypi.python.org/pypi/setuptools" target="_blank" rel="external">https://pypi.python.org/pypi/setuptools</a><br><img src="https://i.imgur.com/v6EWK0b.jpg" alt=""></p><h4 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h4><pre><code>将文件放至你将要装的地方，然后打开cmd进入该文件夹下输入：python setup.py install</code></pre><h3 id="pip的安装"><a href="#pip的安装" class="headerlink" title="pip的安装"></a>pip的安装</h3><h4 id="下载地址-1"><a href="#下载地址-1" class="headerlink" title="下载地址"></a>下载地址</h4><pre><code>https://pypi.python.org/pypi/pip</code></pre><p><img src="https://i.imgur.com/VLcHMDm.jpg" alt=""></p><h4 id="安装-2"><a href="#安装-2" class="headerlink" title="安装"></a>安装</h4><pre><code>将文件放至你将要装的地方，然后打开cmd进入该文件夹下输入：python setup.py install</code></pre><h3 id="python-igraph安装"><a href="#python-igraph安装" class="headerlink" title="python-igraph安装"></a>python-igraph安装</h3><pre><code>首先尝试命令安装：pip install python-igraph如果不成功则用以下办法。</code></pre><h4 id="下载地址-2"><a href="#下载地址-2" class="headerlink" title="下载地址"></a>下载地址</h4><pre><code>http://www.lfd.uci.edu/~gohlke/pythonlibs/#python-igraph找到适合自己系统位数和python版本的python-igraph包下载，比如：</code></pre><p><img src="https://i.imgur.com/T9XEP7x.jpg" alt=""></p><h4 id="安装-3"><a href="#安装-3" class="headerlink" title="安装"></a>安装</h4><pre><code>将文件放至你将要装的地方，然后打开cmd进入该文件夹下输入：pip install 该文件的名字如：pip install python_igraph-0.7.1.post6-cp35-none-win_amd64.whl</code></pre><h3 id="pycairo包的安装"><a href="#pycairo包的安装" class="headerlink" title="pycairo包的安装"></a>pycairo包的安装</h3><h4 id="下载地址-3"><a href="#下载地址-3" class="headerlink" title="下载地址"></a>下载地址</h4><pre><code>http://www.lfd.uci.edu/~gohlke/pythonlibs/#python-igraph如下：</code></pre><p><img src="https://i.imgur.com/4Ig8TVQ.jpg" alt=""></p><h4 id="安装-4"><a href="#安装-4" class="headerlink" title="安装"></a>安装</h4><pre><code>将该文件放到python下的Lib/site-packages/cairo中，cairo是自己创建的文件夹。打开cmd进入到该文件夹中输入：pip install 文件名（比如：pip install pycairo-1.15.2-cp35-cp35m-win_amd64(1).whl）</code></pre><h3 id="python-mysqll连接安装"><a href="#python-mysqll连接安装" class="headerlink" title="python-mysqll连接安装"></a>python-mysqll连接安装</h3><h4 id="命令安装"><a href="#命令安装" class="headerlink" title="命令安装"></a>命令安装</h4><pre><code>pip install pymysql</code></pre><h3 id="igraph画图分析网络"><a href="#igraph画图分析网络" class="headerlink" title="igraph画图分析网络"></a>igraph画图分析网络</h3><h4 id="调试igraph"><a href="#调试igraph" class="headerlink" title="调试igraph"></a>调试igraph</h4><p><img src="https://i.imgur.com/m8jH68E.jpg" alt=""><br>    弹出图片：<br><img src="https://i.imgur.com/fN12g4s.jpg" alt=""></p><h4 id="脚本代码"><a href="#脚本代码" class="headerlink" title="脚本代码"></a>脚本代码</h4><pre><code>from igraph import *import cairoimport pymysqlconn=pymysql.connect(host=&apos;192.168.125.130&apos;,user=&apos;root&apos;,passwd=&apos;123456&apos;,db=&apos;mysql&apos;,charset=&apos;utf8&apos;)cursor=conn.cursor()print(conn)print(cursor)g = Graph()j=0;ip=[];ip1=[];count=0;ip2=[];ips={};ss=0;ss1=0;s3=[]try:    # 执行SQL语句    cursor.execute(&quot;select srcip,dstip from netflowdata&quot;)       # 获取所有记录列表    results = cursor.fetchall()    for row in results:        srcip=row[0]        dstip=row[1]        ip += [srcip, dstip]        #打印结果        print(&quot;srcip=%s,dstip=%s&quot; % (srcip,dstip))except:    print(&quot;Error: unable to fetch data&quot;)s=list(ip)for x in s:    if x not in ip1:        ip1.append(x)s1=list(ip1)for x in s1:    ip2+=[(x,ss)]    ss=ss+1    ips.update(ip2)for i in range(len(ips)):    count=count+1g.add_vertices(count)for x in s1:    g.vs[ss1][&quot;name&quot;] = x    ss1=ss1+1g.vs[&quot;label&quot;]=g.vs[&quot;name&quot;]try:    # 执行SQL语句    cursor.execute(&quot;select srcip,dstip from netflowdata&quot;)    # 获取所有记录列表    results = cursor.fetchall()    for row in results:        srcip=row[0]        dstip=row[1]        x=ips[srcip]        y=ips[dstip]        if (x,y) not in s3:            s3+=[(x,y)]except:    print(&quot;Error: unable to fetch data&quot;)for (x,y) in s3:    if(x,y) and (y,x) in s3:        s3.remove((y,x))for (x,y) in s3:    g.add_edges([(x,y)])summary(g)g.vs[&quot;size&quot;]=30layout=g.layout(&quot;circle&quot;)plot(g,layout=layout)# 关闭数据库连接conn.close()</code></pre><h4 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h4><p><img src="https://i.imgur.com/BiZTahw.jpg" alt=""></p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;软件包的安装&quot;&gt;&lt;a href=&quot;#软件包的安装&quot; class=&quot;headerlink&quot; title=&quot;软件包的安装&quot;&gt;&lt;/a&gt;软件包的安装&lt;/h2&gt;&lt;h3 id=&quot;python的安装&quot;&gt;&lt;a href=&quot;#python的安装&quot; class=&quot;headerlink&quot; title=&quot;python的安装&quot;&gt;&lt;/a&gt;python的安装&lt;/h3&gt;&lt;h4 id=&quot;下载地址&quot;&gt;&lt;a href=&quot;#下载地址&quot; class=&quot;headerlink&quot; title=&quot;下载地址&quot;&gt;&lt;/a&gt;下载地址&lt;/h4&gt;
    
    </summary>
    
      <category term="python" scheme="http://yoursite.com/categories/python/"/>
    
    
      <category term="Cisco" scheme="http://yoursite.com/tags/Cisco/"/>
    
  </entry>
  
  <entry>
    <title>脚本分析NetFlow</title>
    <link href="http://yoursite.com/2017/10/07/%E5%88%86%E6%9E%90NetFlow/"/>
    <id>http://yoursite.com/2017/10/07/分析NetFlow/</id>
    <published>2017-10-07T07:23:10.000Z</published>
    <updated>2017-10-07T08:41:54.359Z</updated>
    
    <content type="html"><![CDATA[<h2 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h2><p>&emsp;&emsp;本次实验中，因为方便，所以选用了kali linux系统在虚拟机中进行操作，实验的思路是，用一个脚本，采用socket编程在本机的端口下进行监听，然后实时抓取数据包并解析，解析出来数据之后，把数据存到数据库中，最后利用Apache2服务器，采用PHP写一个网页，连接数据并把数据库的数据导出到网页上，以表格的形式显示出来。<br><a id="more"></a></p><the rest="" of="" contents="" |="" 余下全文=""><h2 id="抓包解包"><a href="#抓包解包" class="headerlink" title="抓包解包"></a>抓包解包</h2><h3 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h3><p>&emsp;&emsp;由于前面已经进行了netflow的配置，目的IP为192.168.1.10，目的端口为：9996，所以，先给虚拟机桥接之后，配置一个静态的IP地址为上面的地址，如下图所示：<br><img src="https://i.imgur.com/LcIxkI2.jpg" alt=""><br>&emsp;&emsp;然后检测一下python是否存在，打开终端，输入python如下所示则证明正常：<br><img src="https://i.imgur.com/gtMmMKf.jpg" alt=""></p><h3 id="脚本文件创建并打开"><a href="#脚本文件创建并打开" class="headerlink" title="脚本文件创建并打开"></a>脚本文件创建并打开</h3><pre><code>touch netflow.pygedit netflow.py</code></pre><h3 id="抓包解包代码"><a href="#抓包解包代码" class="headerlink" title="抓包解包代码"></a>抓包解包代码</h3><pre><code>import socket, structfrom socket import inet_ntoaSIZE_OF_HEADER = 24SIZE_OF_RECORD = 48sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)sock.bind((&apos;192.168.1.10&apos;, 9996)) #监听本机的端口while True:    buf, addr = sock.recvfrom(1500) #字节设置1500   (version, count) = struct.unpack(&apos;!HH&apos;,buf[0:4])   if version != 5:       print &quot;Not NetFlow v5!&quot;       continue   if count &lt;= 0 or count &gt;= 1000:       print &quot;Invalid count %s&quot; % count       continue   uptime = socket.ntohl(struct.unpack(&apos;I&apos;,buf[4:8])[0])   epochseconds = socket.ntohl(struct.unpack(&apos;I&apos;,buf[8:12])[0])   for i in range(0, count):       try:           base = SIZE_OF_HEADER+(i*SIZE_OF_RECORD)           data = struct.unpack(&apos;!IIIIHH&apos;,buf[base+16:base+36])           nfdata = {}           nfdata[&apos;srcip&apos;] = inet_ntoa(buf[base+0:base+4])           nfdata[&apos;dstip&apos;] = inet_ntoa(buf[base+4:base+8])           nfdata[&apos;nexthop&apos;] = inet_ntoa(buf[base + 8:base + 12])           nfdata[&apos;pcount&apos;] = data[0]           nfdata[&apos;bcount&apos;] = data[1]           nfdata[&apos;stime&apos;] = data[2]           nfdata[&apos;etime&apos;] = data[3]           nfdata[&apos;srcport&apos;] = data[4]           nfdata[&apos;dstport&apos;] = data[5]           nfdata[&apos;protocol&apos;] = ord(buf[base+38])       except:           continue</code></pre><h2 id="导入数据到数据库"><a href="#导入数据到数据库" class="headerlink" title="导入数据到数据库"></a>导入数据到数据库</h2><h3 id="开启数据库服务"><a href="#开启数据库服务" class="headerlink" title="开启数据库服务"></a>开启数据库服务</h3><pre><code>service mysql start</code></pre><h3 id="进入数据库"><a href="#进入数据库" class="headerlink" title="进入数据库"></a>进入数据库</h3><pre><code>mysql</code></pre><p>如图：<br><img src="https://i.imgur.com/U2v7Qa0.jpg" alt=""></p><h3 id="创建数据库"><a href="#创建数据库" class="headerlink" title="创建数据库"></a>创建数据库</h3><pre><code>create database mysql</code></pre><h3 id="创建普通用户并授权"><a href="#创建普通用户并授权" class="headerlink" title="创建普通用户并授权"></a>创建普通用户并授权</h3><pre><code>create user &apos;dbas&apos;@&apos;127.0.0.1&apos; identified by &apos;123456&apos;;grant select,insert,update,delete on mysql.* to dbas@&apos;127.0.0.1&apos;;</code></pre><h3 id="连接数据库并传输数据代码"><a href="#连接数据库并传输数据代码" class="headerlink" title="连接数据库并传输数据代码"></a>连接数据库并传输数据代码</h3><pre><code> import MySQLdb conn=MySQLdb.connect(&apos;127.0.0.1&apos;,user=&apos;dbas&apos;,passwd=&apos;123456&apos;,db=&apos;mysql&apos;,charset=&apos;utf8&apos;) cursor=conn.cursor() print(conn) print(cursor) cursor.execute(&quot;&quot;&quot;  #创建数据库表 create table if not exists netflow (     srcip varchar(20),     srcport varchar(10),     dstip varchar(20),     dstport varchar(10),    nexthop varchar(20),     protocol varchar(10),    pcount varchar(20),     bcount varchar(20),     stime varchar(20),     etime varchar(20) ) &quot;&quot;&quot; )    cursor.execute(&quot;insert into netflow(srcip,srcport,dstip,\    dstport,nexthop,protocol,pcount,bcount,stime,etime)\    values(&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,\    &apos;%s&apos;)&quot;%(nfdata[&apos;srcip&apos;],nfdata[&apos;srcport&apos;],nfdata[&apos;dstip&apos;],\            nfdata[&apos;dstport&apos;],nfdata[&apos;nexthop&apos;],nfdata[&apos;protocol&apos;],\            nfdata[&apos;pcount&apos;],nfdata[&apos;bcount&apos;],nfdata[&apos;stime&apos;],nfdata[&apos;etime&apos;]))    conn.commit()cursor.close()conn.close()</code></pre><h2 id="整个抓包脚本代码"><a href="#整个抓包脚本代码" class="headerlink" title="整个抓包脚本代码"></a>整个抓包脚本代码</h2><pre><code> #!/usr/bin/python # -*- coding: UTF-8 -*- import MySQLdb import socket, struct from socket import inet_ntoa SIZE_OF_HEADER = 24 SIZE_OF_RECORD = 48 conn=MySQLdb.connect(&apos;127.0.0.1&apos;,user=&apos;dbas&apos;,passwd=&apos;123456&apos;,db=&apos;mysql&apos;,charset=&apos;utf8&apos;) cursor=conn.cursor() print(conn) print(cursor) cursor.execute(&quot;&quot;&quot; create table if not exists netflow (     srcip varchar(20),     srcport varchar(10),     dstip varchar(20),     dstport varchar(10),    nexthop varchar(20),     protocol varchar(10),    pcount varchar(20),     bcount varchar(20),     stime varchar(20),     etime varchar(20) ) &quot;&quot;&quot; ) sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM) sock.bind((&apos;192.168.1.10&apos;, 9996)) while True:     buf, addr = sock.recvfrom(1500)    (version, count) = struct.unpack(&apos;!HH&apos;,buf[0:4])    if version != 5:        print &quot;Not NetFlow v5!&quot;        continue    if count &lt;= 0 or count &gt;= 1000:        print &quot;Invalid count %s&quot; % count        continue    uptime = socket.ntohl(struct.unpack(&apos;I&apos;,buf[4:8])[0])    epochseconds = socket.ntohl(struct.unpack(&apos;I&apos;,buf[8:12])[0])    for i in range(0, count):        try:            base = SIZE_OF_HEADER+(i*SIZE_OF_RECORD)            data = struct.unpack(&apos;!IIIIHH&apos;,buf[base+16:base+36])            nfdata = {}            nfdata[&apos;srcip&apos;] = inet_ntoa(buf[base+0:base+4])            nfdata[&apos;dstip&apos;] = inet_ntoa(buf[base+4:base+8])            nfdata[&apos;nexthop&apos;] = inet_ntoa(buf[base + 8:base + 12])            nfdata[&apos;pcount&apos;] = data[0]            nfdata[&apos;bcount&apos;] = data[1]            nfdata[&apos;stime&apos;] = data[2]            nfdata[&apos;etime&apos;] = data[3]            nfdata[&apos;srcport&apos;] = data[4]            nfdata[&apos;dstport&apos;] = data[5]            nfdata[&apos;protocol&apos;] = ord(buf[base+38])        except:            continue    cursor.execute(&quot;insert into netflow(srcip,srcport,dstip,\    dstport,nexthop,protocol,pcount,bcount,stime,etime)\    values(&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,&apos;%s&apos;,\    &apos;%s&apos;)&quot;%(nfdata[&apos;srcip&apos;],nfdata[&apos;srcport&apos;],nfdata[&apos;dstip&apos;],\            nfdata[&apos;dstport&apos;],nfdata[&apos;nexthop&apos;],nfdata[&apos;protocol&apos;],\            nfdata[&apos;pcount&apos;],nfdata[&apos;bcount&apos;],nfdata[&apos;stime&apos;],nfdata[&apos;etime&apos;]))    conn.commit()cursor.close()conn.close()</code></pre><h3 id="查看数据是否导入"><a href="#查看数据是否导入" class="headerlink" title="查看数据是否导入"></a>查看数据是否导入</h3><pre><code>service mysql startmysqluse mysql；select * from netflow；</code></pre><p>如下所示：<br><img src="https://i.imgur.com/77Cl7Zm.jpg" alt=""></p><h2 id="导出数据到网页"><a href="#导出数据到网页" class="headerlink" title="导出数据到网页"></a>导出数据到网页</h2><h3 id="开启Apache2服务"><a href="#开启Apache2服务" class="headerlink" title="开启Apache2服务"></a>开启Apache2服务</h3><pre><code>service apache2 start</code></pre><h3 id="查看php环境"><a href="#查看php环境" class="headerlink" title="查看php环境"></a>查看php环境</h3><pre><code>php -v</code></pre><h3 id="创建文件进行编译"><a href="#创建文件进行编译" class="headerlink" title="创建文件进行编译"></a>创建文件进行编译</h3><pre><code>touch /var/www/html/show.phpgedit /var/www/html/show.php</code></pre><h3 id="导出数据代码"><a href="#导出数据代码" class="headerlink" title="导出数据代码"></a>导出数据代码</h3><pre><code>&lt;html&gt;&lt;head&gt;&lt;title&gt;netflow data&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;center&gt;&lt;h2&gt;Netflow Data Record&lt;/h2&gt;&lt;?php$mysqli=new mysqli(&quot;127.0.0.1&quot;,&quot;dbas&quot;,&quot;123456&quot;,&quot;mysql&quot;);if(mysqli_connect_error())    {    printf(&quot;Connect failed: %s\n&quot;,mysqli_connect_error());    exit();    }$result=$mysqli-&gt;query(&quot;select * from netflow&quot;);echo&quot;&lt;table border=1&gt;&quot;;echo&quot;&lt;tr&gt;&lt;td&gt;srcip&lt;/td&gt;&lt;td&gt;srcport&lt;/td&gt;&lt;td&gt;dstip&lt;/td&gt;&lt;td&gt;dstport&lt;/td&gt;&lt;td&gt;nexthop&lt;/td&gt;&lt;td&gt;protocol&lt;/td&gt;&lt;td&gt;pcount&lt;/td&gt;&lt;td&gt;bcount&lt;/td&gt;&lt;td&gt;stime&lt;/td&gt;&lt;td&gt;etime&lt;/td&gt;&lt;/tr&gt;&quot;;while($row=mysqli_fetch_array($result)){echo&quot;&lt;tr&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[srcip].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[srcport].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[dstip].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[dstport].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[nexthop].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[protocol].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[pcount].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[bcount].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[stime].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;td&gt;&quot;.$row[etime].&quot;&lt;/td&gt;&quot;;echo&quot;&lt;/tr&gt;&quot;;}echo&quot;&lt;/table&gt;&quot;;?&gt;&lt;/center&gt;&lt;/body&gt;&lt;/html&gt;</code></pre><h3 id="导出结果显示"><a href="#导出结果显示" class="headerlink" title="导出结果显示"></a>导出结果显示</h3><p><img src="https://i.imgur.com/m6YxZVJ.jpg" alt=""></p></the>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;简介&quot;&gt;&lt;a href=&quot;#简介&quot; class=&quot;headerlink&quot; title=&quot;简介&quot;&gt;&lt;/a&gt;简介&lt;/h2&gt;&lt;p&gt;&amp;emsp;&amp;emsp;本次实验中，因为方便，所以选用了kali linux系统在虚拟机中进行操作，实验的思路是，用一个脚本，采用socket编程在本机的端口下进行监听，然后实时抓取数据包并解析，解析出来数据之后，把数据存到数据库中，最后利用Apache2服务器，采用PHP写一个网页，连接数据并把数据库的数据导出到网页上，以表格的形式显示出来。&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="python" scheme="http://yoursite.com/tags/python/"/>
    
  </entry>
  
  <entry>
    <title>Netflow配置</title>
    <link href="http://yoursite.com/2017/09/22/netflow%E9%85%8D%E7%BD%AE/"/>
    <id>http://yoursite.com/2017/09/22/netflow配置/</id>
    <published>2017-09-22T03:23:10.000Z</published>
    <updated>2017-10-20T07:56:14.039Z</updated>
    
    <content type="html"><![CDATA[<h2 id="netflow介绍"><a href="#netflow介绍" class="headerlink" title="netflow介绍"></a>netflow介绍</h2><p>&emsp;&emsp;NetFlow是一种数据交换方式，其工作原理是：NetFlow利用标准的交换模式处理数据流的第一个IP包数据，生成NetFlow 缓存，随后同样的数据基于缓存信息在同一个数据流中进行传输，不再匹配相关的访问控制等策略，NetFlow缓存同时包含了随后数据流的统计信息。<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""><br><br>&emsp;&emsp;利用Netflow技术可以监测网络上的IP流（IP flow）信息。采集到的netflow流量信息可以帮助进行网络规划，网络管理，流量计费和病毒检测等等。</the></p><h2 id="分析软件安装"><a href="#分析软件安装" class="headerlink" title="分析软件安装"></a>分析软件安装</h2><p>&emsp;&emsp;安装ManageEngine OpManager软件，本次我们所做的是在Windows系统下，也可以在linux系统下，安装的时候要记住所给的默认端口号，其他默认安装。<br></p><h3 id="下载链接"><a href="#下载链接" class="headerlink" title="下载链接"></a>下载链接</h3><pre><code>http://www.manageengine.com/products/netflow/download.html#more_download</code></pre><h3 id="安装完成界面"><a href="#安装完成界面" class="headerlink" title="安装完成界面"></a>安装完成界面</h3><p>&emsp;&emsp;安装完成之后会自动打开web，需要等待软件初始化模块。<br></p><h4 id="完成界面："><a href="#完成界面：" class="headerlink" title="完成界面："></a>完成界面：</h4><p><img src="https://i.imgur.com/sy35hV6.png" alt=""></p><h4 id="登陆之后界面："><a href="#登陆之后界面：" class="headerlink" title="登陆之后界面："></a>登陆之后界面：</h4><p><img src="https://i.imgur.com/chlAgew.png" alt=""></p><p>注意：<br><br>1.登录名和密码都是默认的admin，并且要点击保持登录。<br><br>2.软件有一个月的试用期，所以有足够的时间进行分析和设置以及检测,到期之后也可以再次安装。</p><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>&emsp;&emsp;Netflower必须在cisco上进行配置，要开启netflow功能，才能进行下一步的检测以及分析，本次以路由器cisco2801为例子。<br></p><h3 id="思科路由器2801配置"><a href="#思科路由器2801配置" class="headerlink" title="思科路由器2801配置"></a>思科路由器2801配置</h3><h4 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h4><pre><code>enableconfigure terminalinterface fastEthernet 0/0ip address 192.168.1.9 255.255.255.0no shutdownexitinterface fastEthernet 0/1ip address 192.168.2.9 255.255.255.0no shutdownexitrouter ripversion 2network 192.168.1.0network 192.168.2.0exit</code></pre><h4 id="netflow部分配置"><a href="#netflow部分配置" class="headerlink" title="netflow部分配置"></a>netflow部分配置</h4><h5 id="config全局状态下配置netflow版本号："><a href="#config全局状态下配置netflow版本号：" class="headerlink" title="config全局状态下配置netflow版本号："></a>config全局状态下配置netflow版本号：</h5><pre><code>router(config)#ip flow-export version 5  </code></pre><p>此命令将netflow配置为版本5。    </p><h5 id="config全局状态下配置netflow服务器地址和端口号："><a href="#config全局状态下配置netflow服务器地址和端口号：" class="headerlink" title="config全局状态下配置netflow服务器地址和端口号："></a>config全局状态下配置netflow服务器地址和端口号：</h5><pre><code>router(config)#ip flow-export destination 192.168.1.10 9996  </code></pre><p>192.168.1.10为netflow服务器地址，即运行netflow版流量监视程序主机的IP地址，9996为服务端口号，即安装软件时的那个端口号。</p><h5 id="在Cisco系列路由器交换机每个接口上（例如interface-fastethernet0-0；interface-fastethernet0-1等）分别进行配置："><a href="#在Cisco系列路由器交换机每个接口上（例如interface-fastethernet0-0；interface-fastethernet0-1等）分别进行配置：" class="headerlink" title="在Cisco系列路由器交换机每个接口上（例如interface fastethernet0/0；interface fastethernet0/1等）分别进行配置："></a>在Cisco系列路由器交换机每个接口上（例如interface fastethernet0/0；interface fastethernet0/1等）分别进行配置：</h5><pre><code>router(config-if)#ip route-cache flow  </code></pre><h5 id="Config全局状态下设置时区"><a href="#Config全局状态下设置时区" class="headerlink" title="Config全局状态下设置时区"></a>Config全局状态下设置时区</h5><pre><code>router(config)#clock timezone Beijing 8  </code></pre><p>此命令配置为北京时间，+8时区。  </p><h5 id="enable状态下设置日期时间"><a href="#enable状态下设置日期时间" class="headerlink" title="enable状态下设置日期时间"></a>enable状态下设置日期时间</h5><pre><code>router#clock set 12：10：20  22 sep 2017  </code></pre><p>此命令配置为2017年9月22日12时10分20秒。<br> </p><h5 id="注意"><a href="#注意" class="headerlink" title="注意:"></a>注意:</h5><p>&emsp;&emsp;先配时区，后设置日期时间。同时接收netflow报文的计算机也要配置成相应的时区。有的Cisco机型断电后，需重新设置日期和时间。<br></p><h5 id="查看命令"><a href="#查看命令" class="headerlink" title="查看命令"></a>查看命令</h5><pre><code>show ip flow export（显示当前Netflow的配置）show ip cache flow（显示当前活动的流的概要，还显示设备输出了多少Netflow数据）</code></pre>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;netflow介绍&quot;&gt;&lt;a href=&quot;#netflow介绍&quot; class=&quot;headerlink&quot; title=&quot;netflow介绍&quot;&gt;&lt;/a&gt;netflow介绍&lt;/h2&gt;&lt;p&gt;&amp;emsp;&amp;emsp;NetFlow是一种数据交换方式，其工作原理是：NetFlow利用标准的交换模式处理数据流的第一个IP包数据，生成NetFlow 缓存，随后同样的数据基于缓存信息在同一个数据流中进行传输，不再匹配相关的访问控制等策略，NetFlow缓存同时包含了随后数据流的统计信息。&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="Cisco" scheme="http://yoursite.com/tags/Cisco/"/>
    
  </entry>
  
  <entry>
    <title>网络地址转换</title>
    <link href="http://yoursite.com/2017/09/19/NAT/"/>
    <id>http://yoursite.com/2017/09/19/NAT/</id>
    <published>2017-09-19T10:33:10.000Z</published>
    <updated>2017-09-19T10:49:26.130Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/9PeSX6X.png" alt=""></p><p>简介：蓝色区域为内网，外边是外网，R1是边缘路由器。<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h2><h3 id="静态NAT"><a href="#静态NAT" class="headerlink" title="静态NAT"></a>静态NAT</h3><h4 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemvlan batch 10 20 100int vlan 10ip add 192.168.1.1 255.255.255.0quitint vlan 20ip add 192.168.2.1 255.255.255.0quitint vlan 100ip add 192.168.3.1 255.255.255.0quitint g0/0/1port link-type accessport default vlan 100quitint g0/0/2port link-type accessport default vlan 10quitint g0/0/3port link-type accessport default vlan 20quit ospf 1area 0network 192.168.1.0 255.255.255.0network 192.168.2.0 255.255.255.0network 192.168.3.0 255.255.255.0quit</code></pre><h4 id="R1"><a href="#R1" class="headerlink" title="R1"></a>R1</h4><pre><code>systemint g0/0/1ip add 192.168.3.2 255.255.255.0quit int g0/0/0ip add 2.2.2.1 255.255.255.0quitospf 1area 0netwokr 192.168.3.0 255.255.255.0quitip route-static 0.0.0.0 0.0.0.0 2.2.2.2ospf 1default-route-advertise alwaysquit两个公网地址：100.100.100.15/24100.100.100.20/24int g0/0/0nat static global 100.100.100.15 inside 192.168.1.2nat static global 100.100.100.20 inside 192.168.2.2</code></pre><h4 id="R3"><a href="#R3" class="headerlink" title="R3"></a>R3</h4><pre><code>systemint g0/0/0ip add 2.2.2.2 255.255.255.0quitint g0/0/1ip add 3.3.3.1 255.255.255.0quitip route-static 100.100.100.15 255.255.255.0 2.2.2.1ip route-static 100.100.100.20 255.255.255.0 2.2.2.1</code></pre><h3 id="动态NAT"><a href="#动态NAT" class="headerlink" title="动态NAT"></a>动态NAT</h3><p>（S1和R1、R3基本配置就不再写出）</p><h4 id="R1-1"><a href="#R1-1" class="headerlink" title="R1"></a>R1</h4><pre><code>公网地址：100.100.100.0/24nat address-group 1 100.100.100.1 100.100.100.254acl 2000rule permit source 192.168.0.0 0.0.255.255quitint g0/0/0nat outbound 2000 address-group 1 no-pat</code></pre><h4 id="R3-1"><a href="#R3-1" class="headerlink" title="R3"></a>R3</h4><pre><code>ip route-static 100.100.100.0 255.255.255.0 2.2.2.1</code></pre><h3 id="PAT-有一个公网地址"><a href="#PAT-有一个公网地址" class="headerlink" title="PAT(有一个公网地址)"></a>PAT(有一个公网地址)</h3><h4 id="R1-2"><a href="#R1-2" class="headerlink" title="R1"></a>R1</h4><pre><code>公网地址：100.100.100.30nat address-group 1 100.100.100.30 100.100.100.30acl 2000rule permit source 192.168.0.0 0.0.255.255quitint g0/0/0nat outbound 2000 address-group 1</code></pre><h4 id="R3-2"><a href="#R3-2" class="headerlink" title="R3"></a>R3</h4><pre><code>ip route-static 100.100.100.30 255.255.255.0 2.2.2.1</code></pre><h3 id="PAT-只有外网接口"><a href="#PAT-只有外网接口" class="headerlink" title="PAT(只有外网接口)"></a>PAT(只有外网接口)</h3><h4 id="R1-3"><a href="#R1-3" class="headerlink" title="R1"></a>R1</h4><pre><code>acl 2000rule permit source 192.168.0.0 0.0.255.255quitint g0/0/0nat outbound 2000</code></pre><h4 id="R3-3"><a href="#R3-3" class="headerlink" title="R3"></a>R3</h4><pre><code>ip route-static 2.2.2.0 255.255.255.0 2.2.2.1</code></pre><h3 id="静态端口映射"><a href="#静态端口映射" class="headerlink" title="静态端口映射"></a>静态端口映射</h3><p>在PAT的基础上输入如下命令：</p><h4 id="R1-4"><a href="#R1-4" class="headerlink" title="R1"></a>R1</h4><pre><code>int g0/0/0 nat static protocol tcp global current-interface telnet inside 192.168.1.2telnet__(将当前接口的23端口映射到192.168.1.2的23端口，这里输出端口号或者协议都可以)</code></pre><p>完结~</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/9PeSX6X.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;简介：蓝色区域为内网，外边是外网，R1是边缘路由器。&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="HUAWEI" scheme="http://yoursite.com/tags/HUAWEI/"/>
    
  </entry>
  
  <entry>
    <title>访问控制列表（ACL）</title>
    <link href="http://yoursite.com/2017/09/17/ACL/"/>
    <id>http://yoursite.com/2017/09/17/ACL/</id>
    <published>2017-09-17T06:23:10.000Z</published>
    <updated>2017-09-19T10:49:15.274Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/fOvSPGZ.png" alt=""></p><p>简介：使vlan20可以访问服务器，vlan30不可以访问服务器，vlan40能访问服务器，但是不能访问服务器的WWW服务。<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h2><h3 id="三层交换机上的基本配置"><a href="#三层交换机上的基本配置" class="headerlink" title="三层交换机上的基本配置"></a>三层交换机上的基本配置</h3><h4 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemvlan batch 10 20 30 40int vlan 10ip add 192.168.10.1 255.255.255.0int g0/0/1port link-type accessport default vlan 10int vlan 20ip add 192.168.20.1 255.255.255.0int g0/0/2port link-type accessport default vlan 20int vlan 30ip add 192.168.30.1 255.255.255.0int g0/0/3port link-type accessport default vlan 30int vlan 40ip add 192.168.40.1 255.255.255.0int g0/0/4port link-type accessport default vlan 40</code></pre><h3 id="基本的ACL配置-服务器拒绝PC3访问"><a href="#基本的ACL配置-服务器拒绝PC3访问" class="headerlink" title="基本的ACL配置(服务器拒绝PC3访问)"></a>基本的ACL配置(服务器拒绝PC3访问)</h3><h4 id="S1-1"><a href="#S1-1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemacl 2000rule deny source 192.168.40.2 0.0.0.255quitint g0/0/1traffic-filter outbound acl 2000</code></pre><h3 id="高级的ACL配置-服务器拒绝PC3访问"><a href="#高级的ACL配置-服务器拒绝PC3访问" class="headerlink" title="高级的ACL配置(服务器拒绝PC3访问)"></a>高级的ACL配置(服务器拒绝PC3访问)</h3><h4 id="S1-2"><a href="#S1-2" class="headerlink" title="S1"></a>S1</h4><pre><code>systemacl 3000rule permit ip source 192.168.20.0 0.0.0.255 destination 192.168.10.0 0.0.0.255rule deny ip source 192.168.30.0 0.0.0.255 destination 192.168.10.0 0.0.0.255 rule deny tcp source 192.168.40.0 0.0.0.255 destination 192.168.10.2 0.0.0.0 destination-port eq 80rule permit ip source anyint g0/0/2traffic-filter inbound acl 3000int g0/0/3traffic-filter inbound acl 3000int g0/0/4traffic-filter inbound acl 3000</code></pre><h2 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h2><p><img src="https://i.imgur.com/xG9zSjf.png" alt=""></p><p><img src="https://i.imgur.com/ysf7hHR.png" alt=""></p><p><img src="https://i.imgur.com/OYywgLL.png" alt=""></p><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>在华为中，acl编号2000~2999为基本的ACL，编号为3000~3999为高级的ACL，在规则rule中，可以自己手配规则号，也可以不配，不配的话系统会自动生成规则号。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/fOvSPGZ.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;简介：使vlan20可以访问服务器，vlan30不可以访问服务器，vlan40能访问服务器，但是不能访问服务器的WWW服务。&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="HUAWEI" scheme="http://yoursite.com/tags/HUAWEI/"/>
    
  </entry>
  
  <entry>
    <title>三层交换机上的VLAN间的通信</title>
    <link href="http://yoursite.com/2017/09/16/vlan%E9%97%B4%E9%80%9A%E4%BF%A1/"/>
    <id>http://yoursite.com/2017/09/16/vlan间通信/</id>
    <published>2017-09-16T08:23:10.000Z</published>
    <updated>2017-09-19T10:49:36.619Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/xC4rgST.png" alt=""><br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h2><h3 id="VLAN10区域配置"><a href="#VLAN10区域配置" class="headerlink" title="VLAN10区域配置"></a>VLAN10区域配置</h3><h4 id="S2"><a href="#S2" class="headerlink" title="S2"></a>S2</h4><pre><code>systemint g0/0/1port link-type accessport default vlan 10int g0/0/2port link-type trunkport trunk allow-pass vlan all</code></pre><h3 id="VLAN20区域配置"><a href="#VLAN20区域配置" class="headerlink" title="VLAN20区域配置"></a>VLAN20区域配置</h3><h4 id="S3"><a href="#S3" class="headerlink" title="S3"></a>S3</h4><pre><code>systemint g0/0/1port link-type trunkport trunk allow-pass vlan allint g0/0/2port link-type accessport default vlan 20</code></pre><h3 id="三层交换机的配置"><a href="#三层交换机的配置" class="headerlink" title="三层交换机的配置"></a>三层交换机的配置</h3><h4 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemvlan 10quitvlan 20quitint vlan 10ip add 192.168.1.1 255.255.255.0quitint vlan 20ip add 192.168.2.1 255.255.255.0quitint g0/0/1port link-type trunkport trunk allow-pass vlan allquitint g0/0/2port link-type trunk port trunk allow-pass vlan all</code></pre><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>   两个不同vlan间通信，三层交换机上需要创建两个vlan，通往两边的出口都设置为trunk模式（port link-type trunk;port trunk allow-pass vlan all),二层交换机上创建各自块的vlan，连接PC的方向为access模式，向上为trunk模式。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/xC4rgST.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="HUAWEI" scheme="http://yoursite.com/tags/HUAWEI/"/>
    
  </entry>
  
  <entry>
    <title>三层交换机作为DHCP服务器</title>
    <link href="http://yoursite.com/2017/09/16/%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%BD%9C%E4%B8%BADHCP%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>http://yoursite.com/2017/09/16/三层交换机作为DHCP服务器/</id>
    <published>2017-09-16T08:23:10.000Z</published>
    <updated>2017-09-19T10:50:02.360Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/xC4rgST.png" alt=""><br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h2><h3 id="VLAN10区域配置"><a href="#VLAN10区域配置" class="headerlink" title="VLAN10区域配置"></a>VLAN10区域配置</h3><h4 id="S2"><a href="#S2" class="headerlink" title="S2"></a>S2</h4><pre><code>systemint g0/0/1port link-type accessport default vlan 10int g0/0/2port link-type trunkport trunk allow-pass vlan all</code></pre><h3 id="VLAN20区域配置"><a href="#VLAN20区域配置" class="headerlink" title="VLAN20区域配置"></a>VLAN20区域配置</h3><h4 id="S3"><a href="#S3" class="headerlink" title="S3"></a>S3</h4><pre><code>systemint g0/0/1port link-type trunkport trunk allow-pass vlan allint g0/0/2port link-type accessport default vlan 20</code></pre><h3 id="三层交换机的配置"><a href="#三层交换机的配置" class="headerlink" title="三层交换机的配置"></a>三层交换机的配置</h3><h4 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemvlan 10quitvlan 20quitint vlan 10ip add 192.168.1.1 255.255.255.0quitint vlan 20ip add 192.168.2.1 255.255.255.0quitint g0/0/1port link-type trunkport trunk allow-pass vlan allquitint g0/0/2port link-type trunk port trunk allow-pass vlan allquitdhcp enableip pool 10network 192.168.1.0 mask 255.255.255.0dns-list 202.196.32.1gateway-list 192.168.1.1lease day 10quitdhcp enableip pool 20network 192.168.2.0 mask 255.255.255.0dns-list 202.196.32.1gateway-list 192.168.2.1lease day 10quitint vlan 10dhcp select globalquitint vlan 20dhcp select global</code></pre><h2 id="验证结果"><a href="#验证结果" class="headerlink" title="验证结果"></a>验证结果</h2><p>PC1的DHCP结果</p><p><img src="https://i.imgur.com/z76eCz0.png" alt=""></p><p>PC2的DHCP结果</p><p><img src="https://i.imgur.com/SrkpS31.png" alt=""></p><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>  在之前的不同见vlan通信的top基础上，把三层交换机作为DHCP服务器，配置在三层交换机上配置，配置完之后把PC换为DHCP就可以了。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/xC4rgST.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="HUAWEI" scheme="http://yoursite.com/tags/HUAWEI/"/>
    
  </entry>
  
  <entry>
    <title>路由的重分布</title>
    <link href="http://yoursite.com/2017/09/16/%E8%B7%AF%E7%94%B1%E9%87%8D%E5%88%86%E5%B8%83/"/>
    <id>http://yoursite.com/2017/09/16/路由重分布/</id>
    <published>2017-09-16T06:30:20.000Z</published>
    <updated>2017-09-19T10:49:55.008Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/XoUYa0m.png" alt=""><br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="重分布的详细配置"><a href="#重分布的详细配置" class="headerlink" title="重分布的详细配置"></a>重分布的详细配置</h2><h3 id="RIP区域配置"><a href="#RIP区域配置" class="headerlink" title="RIP区域配置"></a>RIP区域配置</h3><h4 id="AR4"><a href="#AR4" class="headerlink" title="AR4"></a>AR4</h4><pre><code>systemint g0/0/1ip add 192.168.1.2 255.255.255.0int g0/0/0ip add 192.168.2.1 255.255.255.0rip 1version 2network 192.168.1.0network 192.168.2.0</code></pre><h4 id="AR5"><a href="#AR5" class="headerlink" title="AR5"></a>AR5</h4><pre><code>systemint g0/0/0ip add 192.168.2.2 255.255.255.0int g0/0/1ip add 192.168.3.1 255.255.255.0rip 1version 2network 192.168.2.0network 192.168.3.0</code></pre><h4 id="AR6"><a href="#AR6" class="headerlink" title="AR6"></a>AR6</h4><pre><code>systemint g0/0/0ip add 192.168.3.2 255.255.255.0int g0/0/1ip add 192.168.4.1 255.255.255.0rip 1version 2network 192.168.3.0</code></pre><h3 id="OSPF区域配置"><a href="#OSPF区域配置" class="headerlink" title="OSPF区域配置"></a>OSPF区域配置</h3><h4 id="AR6-1"><a href="#AR6-1" class="headerlink" title="AR6"></a>AR6</h4><pre><code>systemospf 1area 0network 192.168.4.0 0.0.0.255</code></pre><h4 id="AR7"><a href="#AR7" class="headerlink" title="AR7"></a>AR7</h4><pre><code>systemint g0/0/0ip add 192.168.4.2 255.255.255.0int g0/0/1ip add 192.168.5.1 255.255.255.0ospf 1area 0network 192.168.4.0 0.0.0.255network 192.168.5.0 0.0.0.255</code></pre><h4 id="AR8"><a href="#AR8" class="headerlink" title="AR8"></a>AR8</h4><pre><code>systemint g0/0/0ip add 192.168.5.2 255.255.255.0int g0/0/1ip add 192.168.6.1 255.255.255.0ospf 1area 0network 192.168.5.0 0.0.0.255network 192.168.6.0 0.0.0.255</code></pre><h3 id="重分布的配置"><a href="#重分布的配置" class="headerlink" title="重分布的配置"></a>重分布的配置</h3><h4 id="AR6-2"><a href="#AR6-2" class="headerlink" title="AR6"></a>AR6</h4><pre><code>systemrip 1version 2import-route ospf 1 cost 10ospf 1import-route rip 1 cost 10</code></pre><h3 id="重分布的知识点"><a href="#重分布的知识点" class="headerlink" title="重分布的知识点"></a>重分布的知识点</h3><p>   需在两个不同协议的区域的边界路由器上配置重分布的命令，首先要进入协议模式下（ospf/rip），比如先进入rip，就在rip模式下重分布ospf协议（import-route ospf 1 cost 10），其中数字1为进程号，数字10为跳数，也就是从两个网络的末端到达另外这个网络的跳数；然后再进入ospf模式中，如上相同。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/XoUYa0m.png&quot; alt=&quot;&quot;&gt;&lt;br&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="HUAWEI" scheme="http://yoursite.com/tags/HUAWEI/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2017/09/15/hello-world/"/>
    <id>http://yoursite.com/2017/09/15/hello-world/</id>
    <published>2017-09-15T05:20:35.000Z</published>
    <updated>2017-09-16T05:35:39.155Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;.&lt;br&gt;
    
    </summary>
    
      <category term="hexo" scheme="http://yoursite.com/categories/hexo/"/>
    
    
      <category term="blog" scheme="http://yoursite.com/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>KMS服务器搭建及使用</title>
    <link href="http://yoursite.com/2017/07/24/KMS%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2017/07/24/KMS服务器搭建及使用/</id>
    <published>2017-07-24T10:20:35.000Z</published>
    <updated>2017-07-31T03:51:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>KMS激活 操作系统 office(VOL)版激活<br>准备：Centos7操作系统，py-kms<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="KMS服务器搭建"><a href="#KMS服务器搭建" class="headerlink" title="KMS服务器搭建"></a>KMS服务器搭建</h2><h3 id="py-kms下载"><a href="#py-kms下载" class="headerlink" title="py-kms下载"></a>py-kms下载</h3><pre><code>https://github.com/matsuz/py-kms</code></pre><h3 id="Centos7安装运行py-kms的依赖包"><a href="#Centos7安装运行py-kms的依赖包" class="headerlink" title="Centos7安装运行py-kms的依赖包"></a>Centos7安装运行py-kms的依赖包</h3><pre><code>root# yum install python-argparse</code></pre><h3 id="下载代码"><a href="#下载代码" class="headerlink" title="下载代码"></a>下载代码</h3><pre><code>git clone https://github.com/matsuz/py-kms</code></pre><h3 id="运行激活服务器"><a href="#运行激活服务器" class="headerlink" title="运行激活服务器"></a>运行激活服务器</h3><pre><code>root# cd py-kmsroot# python server.py</code></pre><h3 id="如果看到如下消息则证明安装成功"><a href="#如果看到如下消息则证明安装成功" class="headerlink" title="如果看到如下消息则证明安装成功"></a>如果看到如下消息则证明安装成功</h3><pre><code>root# TCP server listenling at 0.0.0.0 on port 1688.</code></pre><p>到此kms服务器搭建完毕，但是我们为了让其长期不间断运行我们还需要进行接下来的步奏<br><br><br>——- —- 华丽的分割线 —- ——-</p><h2 id="长期运行配置"><a href="#长期运行配置" class="headerlink" title="长期运行配置"></a>长期运行配置</h2><h3 id="使用supervisor管理py-kms服务"><a href="#使用supervisor管理py-kms服务" class="headerlink" title="使用supervisor管理py-kms服务"></a>使用supervisor管理py-kms服务</h3><p>拷贝py-kms文件到/usr/local/目录下<br></p><pre><code>cp -r py-kms /usr/local/</code></pre><h3 id="安装supervisor"><a href="#安装supervisor" class="headerlink" title="安装supervisor"></a>安装supervisor</h3><pre><code>yum install python-setuptoolseasy_install supervisor</code></pre><h3 id="生成默认配置文件"><a href="#生成默认配置文件" class="headerlink" title="生成默认配置文件"></a>生成默认配置文件</h3><pre><code>&apos;echo_supervisord_conf&gt; /etc/supervisord.conf&apos;</code></pre><h3 id="编写supervisor脚本，加到-etc-supervisord-conf最后"><a href="#编写supervisor脚本，加到-etc-supervisord-conf最后" class="headerlink" title="编写supervisor脚本，加到/etc/supervisord.conf最后"></a>编写supervisor脚本，加到/etc/supervisord.conf最后</h3><pre><code>[program:pykms]command=python /usr/local/py-kms/server.pyautorestart=trueuser=root</code></pre><h3 id="以deamon方式运行，执行"><a href="#以deamon方式运行，执行" class="headerlink" title="以deamon方式运行，执行"></a>以deamon方式运行，执行</h3><pre><code>supervisord</code></pre><p><br></p><p>——- —- 华丽的分割线 —- ——-</p><h2 id="客户端测试"><a href="#客户端测试" class="headerlink" title="客户端测试"></a>客户端测试</h2><pre><code>cd py-kmspython client.py -v 服务器ip</code></pre><h3 id="结果如下说明安装成功"><a href="#结果如下说明安装成功" class="headerlink" title="结果如下说明安装成功"></a>结果如下说明安装成功</h3><pre><code>Connecting to 服务器ip on port 1688...Connection successful!Sending RPC bind request...RPC bind acknowledged.</code></pre><p>——- —- 华丽的分割线 —- ——-</p><h2 id="如果激活的时候出现如图错误"><a href="#如果激活的时候出现如图错误" class="headerlink" title="如果激活的时候出现如图错误"></a>如果激活的时候出现如图错误</h2><p><img src="http://i.imgur.com/rCQQSmQ.png" alt=""><br>这是因为centos7 服务器的防火墙没有添加策略，需要添加规则。如果服务器放在了云端。云端的安全组，也需要添加一天允许1688端口连接的规则<br>这里我们只讨论，Centos7的防火墙设置</p><h3 id="错误排查"><a href="#错误排查" class="headerlink" title="错误排查"></a>错误排查</h3><p>Centos7 自带的防火墙是firewall。我不习惯用，就禁用掉，然后安装使用iptables防火墙规则</p><h3 id="关闭firewall"><a href="#关闭firewall" class="headerlink" title="关闭firewall:"></a>关闭firewall:</h3><pre><code>service firewalld stopsystemctl disable firewalld.service #禁止firewall开机启动</code></pre><h3 id="安装iptables防火墙"><a href="#安装iptables防火墙" class="headerlink" title="安装iptables防火墙"></a>安装iptables防火墙</h3><pre><code>yum install iptables-service</code></pre><h3 id="编辑iptables防火墙配置-添加开放1688端口"><a href="#编辑iptables防火墙配置-添加开放1688端口" class="headerlink" title="编辑iptables防火墙配置 添加开放1688端口"></a>编辑iptables防火墙配置 添加开放1688端口</h3><pre><code>vim /etc/sysconfig/iptables</code></pre><p>下面是一个完整的配置文件内容：<br></p><pre><code>Firewall configuration written by system-config-firewallManual customization of this file is not recommended.*filter:INPUT ACCEPT [0:0]:FORWARD ACCEPT [0:0]:OUTPUT ACCEPT [0:0]-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT-A INPUT -p icmp -j ACCEPT-A INPUT -i lo -j ACCEPT-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT-A INPUT -m state --state NEW -m tcp -p tcp --dport 1688 -j ACCEPT-A INPUT -j REJECT --reject-with icmp-host-prohibited-A FORWARD -j REJECT --reject-with icmp-host-prohibitedCOMMIT</code></pre><h3 id="wq-保存退出"><a href="#wq-保存退出" class="headerlink" title="wq!保存退出"></a>wq!保存退出</h3><pre><code>service iptables start #开启systemctl enable iptables.service #设置防火墙开机启动</code></pre><p>##激活演示<br>以管理员权限运行CMD命令提示符<br>输入命令</p><pre><code>slmgr /ipk xxxxxxxxxxxxxxxxxxxx (对应版本的KMS激活密钥 参考下面附录1)slmgr /skms 服务器ip或者域名（如 kms.damowang.cn）slmgr /ato </code></pre><p><img src="http://i.imgur.com/zuRhckU.png" alt=""><br>系统成功激活<br><br><br>附录1：<a href="https://technet.microsoft.com/en-us/library/jj612867.aspx" title="KMS激活密钥对照表" target="_blank" rel="external">https://technet.microsoft.com/en-us/library/jj612867.aspx</a></p><p>激活office<br></p><pre><code>cscript &quot;C:\Program Files (x86)\Microsoft Office\Office14\OSPP.vbs&quot; /sethst: xxxxxx(xxxxxx用kms域名或者ip地址代替)cscript &quot;C:\Program Files (x86)\Microsoft Office\Office14\OSPP.vbs&quot; /ato</code></pre><p>注意激活office必须是VOL版本而不能是Retail版本。如果激活出现错误，注意查看版本，路径是否正确，ip是否正确可用。激活用的密钥是否正确，若提示密钥无效尝试更换office密钥。<br></p><pre><code>cscript ospp.vbs /dstatus</code></pre><p><img src="http://i.imgur.com/5Q2kuD5.png" alt=""></p><p>显示当前已安装产品密钥的许可证信息。可以查看到自已安裝的版本有多少个序列号。</p><pre><code>cscript ospp.vbs /unpkey:xxxxx</code></pre><p><img src="http://i.imgur.com/5TSR9OH.png" alt=""></p><p>卸载已安装的产品密钥。后面的数字是密钥的最后5位数。</p><p>此时再执行cscript ospp.vbs /dstatus发现产品密钥已经没有了，我重新进行导入。</p><pre><code>cscript ospp.vbs /inpkey:xxxxx…… (xxxx代表对应版本的密钥可自己在网上找，也可以在微软官网 )</code></pre><p>安装、替换现有的产品密钥。和上面的过程刚好相反。</p><pre><code>cscript ospp.vbs /sethst:x.x.x.x</code></pre><p>设置KMS主机名。一般为IP地址。</p><pre><code>cscript ospp.vbs /act</code></pre><p>激活当前安装的Office。</p><p>如果office曾经用其它的KMS服务器激活。一定要用</p><pre><code>cscript OSPP.vbs /remhst</code></pre><p>移除kms主机，再执行以上命令 <br>错误排查以及对应KMS KEY 参见附录2<br><br><br>附录2：<a href="https://technet.microsoft.com/zh-cn/library/ee624355(v=office.14).aspx" target="_blank" rel="external">https://technet.microsoft.com/zh-cn/library/ee624355(v=office.14).aspx</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;KMS激活 操作系统 office(VOL)版激活&lt;br&gt;准备：Centos7操作系统，py-kms&lt;br&gt;
    
    </summary>
    
      <category term="know" scheme="http://yoursite.com/categories/know/"/>
    
    
      <category term="pykms" scheme="http://yoursite.com/tags/pykms/"/>
    
  </entry>
  
</feed>
