<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>MyLife</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2017-09-17T06:15:41.754Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Gong Min</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title></title>
    <link href="http://yoursite.com/2017/09/17/ACL/"/>
    <id>http://yoursite.com/2017/09/17/ACL/</id>
    <published>2017-09-17T06:15:41.754Z</published>
    <updated>2017-09-17T06:15:41.754Z</updated>
    
    <summary type="html">
    
    </summary>
    
    
  </entry>
  
  <entry>
    <title>三层交换机上的VLAN间的通信</title>
    <link href="http://yoursite.com/2017/09/16/vlan%E9%97%B4%E9%80%9A%E4%BF%A1/"/>
    <id>http://yoursite.com/2017/09/16/vlan间通信/</id>
    <published>2017-09-16T08:23:10.000Z</published>
    <updated>2017-09-16T08:47:06.983Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/xC4rgST.png" alt=""></p><h2 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h2><a id="more"></a><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h3 id="VLAN10区域配置"><a href="#VLAN10区域配置" class="headerlink" title="VLAN10区域配置"></a>VLAN10区域配置</h3><h4 id="S2"><a href="#S2" class="headerlink" title="S2"></a>S2</h4><pre><code>systemint g0/0/1port link-type accessport default vlan 10int g0/0/2port link-type trunkport trunk allow-pass vlan all</code></pre><h3 id="VLAN20区域配置"><a href="#VLAN20区域配置" class="headerlink" title="VLAN20区域配置"></a>VLAN20区域配置</h3><h4 id="S3"><a href="#S3" class="headerlink" title="S3"></a>S3</h4><pre><code>systemint g0/0/1port link-type trunkport trunk allow-pass vlan allint g0/0/2port link-type accessport default vlan 20</code></pre><h3 id="三层交换机的配置"><a href="#三层交换机的配置" class="headerlink" title="三层交换机的配置"></a>三层交换机的配置</h3><h4 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemvlan 10quitvlan 20quitint vlan 10ip add 192.168.1.1 255.255.255.0quitint vlan 20ip add 192.168.2.1 255.255.255.0quitint g0/0/1port link-type trunkport trunk allow-pass vlan allquitint g0/0/2port link-type trunk port trunk allow-pass vlan all</code></pre><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>   两个不同vlan间通信，三层交换机上需要创建两个vlan，通往两边的出口都设置为trunk模式（port link-type trunk;port trunk allow-pass vlan all),二层交换机上创建各自块的vlan，连接PC的方向为access模式，向上为trunk模式。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/xC4rgST.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;详细配置&quot;&gt;&lt;a href=&quot;#详细配置&quot; class=&quot;headerlink&quot; title=&quot;详细配置&quot;&gt;&lt;/a&gt;详细配置&lt;/h2&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="华为" scheme="http://yoursite.com/tags/%E5%8D%8E%E4%B8%BA/"/>
    
  </entry>
  
  <entry>
    <title>三层交换机作为DHCP服务器</title>
    <link href="http://yoursite.com/2017/09/16/%E4%B8%89%E5%B1%82%E4%BA%A4%E6%8D%A2%E6%9C%BA%E4%BD%9C%E4%B8%BADHCP%E6%9C%8D%E5%8A%A1%E5%99%A8/"/>
    <id>http://yoursite.com/2017/09/16/三层交换机作为DHCP服务器/</id>
    <published>2017-09-16T08:23:10.000Z</published>
    <updated>2017-09-16T09:16:43.165Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/xC4rgST.png" alt=""></p><h2 id="详细配置"><a href="#详细配置" class="headerlink" title="详细配置"></a>详细配置</h2><a id="more"></a><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h3 id="VLAN10区域配置"><a href="#VLAN10区域配置" class="headerlink" title="VLAN10区域配置"></a>VLAN10区域配置</h3><h4 id="S2"><a href="#S2" class="headerlink" title="S2"></a>S2</h4><pre><code>systemint g0/0/1port link-type accessport default vlan 10int g0/0/2port link-type trunkport trunk allow-pass vlan all</code></pre><h3 id="VLAN20区域配置"><a href="#VLAN20区域配置" class="headerlink" title="VLAN20区域配置"></a>VLAN20区域配置</h3><h4 id="S3"><a href="#S3" class="headerlink" title="S3"></a>S3</h4><pre><code>systemint g0/0/1port link-type trunkport trunk allow-pass vlan allint g0/0/2port link-type accessport default vlan 20</code></pre><h3 id="三层交换机的配置"><a href="#三层交换机的配置" class="headerlink" title="三层交换机的配置"></a>三层交换机的配置</h3><h4 id="S1"><a href="#S1" class="headerlink" title="S1"></a>S1</h4><pre><code>systemvlan 10quitvlan 20quitint vlan 10ip add 192.168.1.1 255.255.255.0quitint vlan 20ip add 192.168.2.1 255.255.255.0quitint g0/0/1port link-type trunkport trunk allow-pass vlan allquitint g0/0/2port link-type trunk port trunk allow-pass vlan allquitdhcp enableip pool 10network 192.168.1.0 mask 255.255.255.0dns-list 202.196.32.1gateway-list 192.168.1.1lease day 10quitdhcp enableip pool 20network 192.168.2.0 mask 255.255.255.0dns-list 202.196.32.1gateway-list 192.168.2.1lease day 10quitint vlan 10dhcp select globalquitint vlan 20dhcp select global</code></pre><h2 id="验证结果"><a href="#验证结果" class="headerlink" title="验证结果"></a>验证结果</h2><p>PC1的DHCP结果</p><p><img src="https://i.imgur.com/z76eCz0.png" alt=""></p><p>PC2的DHCP结果</p><p><img src="https://i.imgur.com/SrkpS31.png" alt=""></p><h2 id="知识点"><a href="#知识点" class="headerlink" title="知识点"></a>知识点</h2><p>  在之前的不同见vlan通信的top基础上，把三层交换机作为DHCP服务器，配置在三层交换机上配置，配置完之后把PC换为DHCP就可以了。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/xC4rgST.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;详细配置&quot;&gt;&lt;a href=&quot;#详细配置&quot; class=&quot;headerlink&quot; title=&quot;详细配置&quot;&gt;&lt;/a&gt;详细配置&lt;/h2&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="华为" scheme="http://yoursite.com/tags/%E5%8D%8E%E4%B8%BA/"/>
    
  </entry>
  
  <entry>
    <title>路由的重分布</title>
    <link href="http://yoursite.com/2017/09/16/%E8%B7%AF%E7%94%B1%E9%87%8D%E5%88%86%E5%B8%83/"/>
    <id>http://yoursite.com/2017/09/16/路由重分布/</id>
    <published>2017-09-16T06:30:20.000Z</published>
    <updated>2017-09-16T08:47:09.047Z</updated>
    
    <content type="html"><![CDATA[<h2 id="TOP图"><a href="#TOP图" class="headerlink" title="TOP图"></a>TOP图</h2><p><img src="https://i.imgur.com/XoUYa0m.png" alt=""></p><h2 id="重分布的详细配置"><a href="#重分布的详细配置" class="headerlink" title="重分布的详细配置"></a>重分布的详细配置</h2><a id="more"></a><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h3 id="RIP区域配置"><a href="#RIP区域配置" class="headerlink" title="RIP区域配置"></a>RIP区域配置</h3><h4 id="AR4"><a href="#AR4" class="headerlink" title="AR4"></a>AR4</h4><pre><code>systemint g0/0/1ip add 192.168.1.2 255.255.255.0int g0/0/0ip add 192.168.2.1 255.255.255.0rip 1version 2network 192.168.1.0network 192.168.2.0</code></pre><h4 id="AR5"><a href="#AR5" class="headerlink" title="AR5"></a>AR5</h4><pre><code>systemint g0/0/0ip add 192.168.2.2 255.255.255.0int g0/0/1ip add 192.168.3.1 255.255.255.0rip 1version 2network 192.168.2.0network 192.168.3.0</code></pre><h4 id="AR6"><a href="#AR6" class="headerlink" title="AR6"></a>AR6</h4><pre><code>systemint g0/0/0ip add 192.168.3.2 255.255.255.0int g0/0/1ip add 192.168.4.1 255.255.255.0rip 1version 2network 192.168.3.0</code></pre><h3 id="OSPF区域配置"><a href="#OSPF区域配置" class="headerlink" title="OSPF区域配置"></a>OSPF区域配置</h3><h4 id="AR6-1"><a href="#AR6-1" class="headerlink" title="AR6"></a>AR6</h4><pre><code>systemospf 1area 0network 192.168.4.0 0.0.0.255</code></pre><h4 id="AR7"><a href="#AR7" class="headerlink" title="AR7"></a>AR7</h4><pre><code>systemint g0/0/0ip add 192.168.4.2 255.255.255.0int g0/0/1ip add 192.168.5.1 255.255.255.0ospf 1area 0network 192.168.4.0 0.0.0.255network 192.168.5.0 0.0.0.255</code></pre><h4 id="AR8"><a href="#AR8" class="headerlink" title="AR8"></a>AR8</h4><pre><code>systemint g0/0/0ip add 192.168.5.2 255.255.255.0int g0/0/1ip add 192.168.6.1 255.255.255.0ospf 1area 0network 192.168.5.0 0.0.0.255network 192.168.6.0 0.0.0.255</code></pre><h3 id="重分布的配置"><a href="#重分布的配置" class="headerlink" title="重分布的配置"></a>重分布的配置</h3><h4 id="AR6-2"><a href="#AR6-2" class="headerlink" title="AR6"></a>AR6</h4><pre><code>systemrip 1version 2import-route ospf 1 cost 10ospf 1import-route rip 1 cost 10</code></pre><h3 id="重分布的知识点"><a href="#重分布的知识点" class="headerlink" title="重分布的知识点"></a>重分布的知识点</h3><p>   需在两个不同协议的区域的边界路由器上配置重分布的命令，首先要进入协议模式下（ospf/rip），比如先进入rip，就在rip模式下重分布ospf协议（import-route ospf 1 cost 10），其中数字1为进程号，数字10为跳数，也就是从两个网络的末端到达另外这个网络的跳数；然后再进入ospf模式中，如上相同。</p>]]></content>
    
    <summary type="html">
    
      &lt;h2 id=&quot;TOP图&quot;&gt;&lt;a href=&quot;#TOP图&quot; class=&quot;headerlink&quot; title=&quot;TOP图&quot;&gt;&lt;/a&gt;TOP图&lt;/h2&gt;&lt;p&gt;&lt;img src=&quot;https://i.imgur.com/XoUYa0m.png&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;h2 id=&quot;重分布的详细配置&quot;&gt;&lt;a href=&quot;#重分布的详细配置&quot; class=&quot;headerlink&quot; title=&quot;重分布的详细配置&quot;&gt;&lt;/a&gt;重分布的详细配置&lt;/h2&gt;
    
    </summary>
    
      <category term="路由" scheme="http://yoursite.com/categories/%E8%B7%AF%E7%94%B1/"/>
    
    
      <category term="华为" scheme="http://yoursite.com/tags/%E5%8D%8E%E4%B8%BA/"/>
    
  </entry>
  
  <entry>
    <title>Hello World</title>
    <link href="http://yoursite.com/2017/09/15/hello-world/"/>
    <id>http://yoursite.com/2017/09/15/hello-world/</id>
    <published>2017-09-15T05:20:35.000Z</published>
    <updated>2017-09-16T05:35:39.155Z</updated>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/" target="_blank" rel="external">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/" target="_blank" rel="external">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html" target="_blank" rel="external">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues" target="_blank" rel="external">GitHub</a>.<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo new <span class="string">"My New Post"</span></div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html" target="_blank" rel="external">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo server</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html" target="_blank" rel="external">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo generate</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html" target="_blank" rel="external">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$ hexo deploy</div></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/deployment.html" target="_blank" rel="external">Deployment</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;Welcome to &lt;a href=&quot;https://hexo.io/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Hexo&lt;/a&gt;! This is your very first post. Check &lt;a href=&quot;https://hexo.io/docs/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;documentation&lt;/a&gt; for more info. If you get any problems when using Hexo, you can find the answer in &lt;a href=&quot;https://hexo.io/docs/troubleshooting.html&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;troubleshooting&lt;/a&gt; or you can ask me on &lt;a href=&quot;https://github.com/hexojs/hexo/issues&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;GitHub&lt;/a&gt;.&lt;br&gt;
    
    </summary>
    
      <category term="hexo" scheme="http://yoursite.com/categories/hexo/"/>
    
    
      <category term="blog" scheme="http://yoursite.com/tags/blog/"/>
    
  </entry>
  
  <entry>
    <title>KMS服务器搭建及使用</title>
    <link href="http://yoursite.com/2017/07/24/KMS%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA%E5%8F%8A%E4%BD%BF%E7%94%A8/"/>
    <id>http://yoursite.com/2017/07/24/KMS服务器搭建及使用/</id>
    <published>2017-07-24T10:20:35.000Z</published>
    <updated>2017-07-31T03:51:42.000Z</updated>
    
    <content type="html"><![CDATA[<p>KMS激活 操作系统 office(VOL)版激活<br>准备：Centos7操作系统，py-kms<br><a id="more"></a></p><p><the rest="" of="" contents="" |="" 余下全文=""></the></p><h2 id="KMS服务器搭建"><a href="#KMS服务器搭建" class="headerlink" title="KMS服务器搭建"></a>KMS服务器搭建</h2><h3 id="py-kms下载"><a href="#py-kms下载" class="headerlink" title="py-kms下载"></a>py-kms下载</h3><pre><code>https://github.com/matsuz/py-kms</code></pre><h3 id="Centos7安装运行py-kms的依赖包"><a href="#Centos7安装运行py-kms的依赖包" class="headerlink" title="Centos7安装运行py-kms的依赖包"></a>Centos7安装运行py-kms的依赖包</h3><pre><code>root# yum install python-argparse</code></pre><h3 id="下载代码"><a href="#下载代码" class="headerlink" title="下载代码"></a>下载代码</h3><pre><code>git clone https://github.com/matsuz/py-kms</code></pre><h3 id="运行激活服务器"><a href="#运行激活服务器" class="headerlink" title="运行激活服务器"></a>运行激活服务器</h3><pre><code>root# cd py-kmsroot# python server.py</code></pre><h3 id="如果看到如下消息则证明安装成功"><a href="#如果看到如下消息则证明安装成功" class="headerlink" title="如果看到如下消息则证明安装成功"></a>如果看到如下消息则证明安装成功</h3><pre><code>root# TCP server listenling at 0.0.0.0 on port 1688.</code></pre><p>到此kms服务器搭建完毕，但是我们为了让其长期不间断运行我们还需要进行接下来的步奏<br><br><br>——- —- 华丽的分割线 —- ——-</p><h2 id="长期运行配置"><a href="#长期运行配置" class="headerlink" title="长期运行配置"></a>长期运行配置</h2><h3 id="使用supervisor管理py-kms服务"><a href="#使用supervisor管理py-kms服务" class="headerlink" title="使用supervisor管理py-kms服务"></a>使用supervisor管理py-kms服务</h3><p>拷贝py-kms文件到/usr/local/目录下<br></p><pre><code>cp -r py-kms /usr/local/</code></pre><h3 id="安装supervisor"><a href="#安装supervisor" class="headerlink" title="安装supervisor"></a>安装supervisor</h3><pre><code>yum install python-setuptoolseasy_install supervisor</code></pre><h3 id="生成默认配置文件"><a href="#生成默认配置文件" class="headerlink" title="生成默认配置文件"></a>生成默认配置文件</h3><pre><code>&apos;echo_supervisord_conf&gt; /etc/supervisord.conf&apos;</code></pre><h3 id="编写supervisor脚本，加到-etc-supervisord-conf最后"><a href="#编写supervisor脚本，加到-etc-supervisord-conf最后" class="headerlink" title="编写supervisor脚本，加到/etc/supervisord.conf最后"></a>编写supervisor脚本，加到/etc/supervisord.conf最后</h3><pre><code>[program:pykms]command=python /usr/local/py-kms/server.pyautorestart=trueuser=root</code></pre><h3 id="以deamon方式运行，执行"><a href="#以deamon方式运行，执行" class="headerlink" title="以deamon方式运行，执行"></a>以deamon方式运行，执行</h3><pre><code>supervisord</code></pre><p><br></p><p>——- —- 华丽的分割线 —- ——-</p><h2 id="客户端测试"><a href="#客户端测试" class="headerlink" title="客户端测试"></a>客户端测试</h2><pre><code>cd py-kmspython client.py -v 服务器ip</code></pre><h3 id="结果如下说明安装成功"><a href="#结果如下说明安装成功" class="headerlink" title="结果如下说明安装成功"></a>结果如下说明安装成功</h3><pre><code>Connecting to 服务器ip on port 1688...Connection successful!Sending RPC bind request...RPC bind acknowledged.</code></pre><p>——- —- 华丽的分割线 —- ——-</p><h2 id="如果激活的时候出现如图错误"><a href="#如果激活的时候出现如图错误" class="headerlink" title="如果激活的时候出现如图错误"></a>如果激活的时候出现如图错误</h2><p><img src="http://i.imgur.com/rCQQSmQ.png" alt=""><br>这是因为centos7 服务器的防火墙没有添加策略，需要添加规则。如果服务器放在了云端。云端的安全组，也需要添加一天允许1688端口连接的规则<br>这里我们只讨论，Centos7的防火墙设置</p><h3 id="错误排查"><a href="#错误排查" class="headerlink" title="错误排查"></a>错误排查</h3><p>Centos7 自带的防火墙是firewall。我不习惯用，就禁用掉，然后安装使用iptables防火墙规则</p><h3 id="关闭firewall"><a href="#关闭firewall" class="headerlink" title="关闭firewall:"></a>关闭firewall:</h3><pre><code>service firewalld stopsystemctl disable firewalld.service #禁止firewall开机启动</code></pre><h3 id="安装iptables防火墙"><a href="#安装iptables防火墙" class="headerlink" title="安装iptables防火墙"></a>安装iptables防火墙</h3><pre><code>yum install iptables-service</code></pre><h3 id="编辑iptables防火墙配置-添加开放1688端口"><a href="#编辑iptables防火墙配置-添加开放1688端口" class="headerlink" title="编辑iptables防火墙配置 添加开放1688端口"></a>编辑iptables防火墙配置 添加开放1688端口</h3><pre><code>vim /etc/sysconfig/iptables</code></pre><p>下面是一个完整的配置文件内容：<br></p><pre><code>Firewall configuration written by system-config-firewallManual customization of this file is not recommended.*filter:INPUT ACCEPT [0:0]:FORWARD ACCEPT [0:0]:OUTPUT ACCEPT [0:0]-A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT-A INPUT -p icmp -j ACCEPT-A INPUT -i lo -j ACCEPT-A INPUT -m state --state NEW -m tcp -p tcp --dport 22 -j ACCEPT-A INPUT -m state --state NEW -m tcp -p tcp --dport 80 -j ACCEPT-A INPUT -m state --state NEW -m tcp -p tcp --dport 1688 -j ACCEPT-A INPUT -j REJECT --reject-with icmp-host-prohibited-A FORWARD -j REJECT --reject-with icmp-host-prohibitedCOMMIT</code></pre><h3 id="wq-保存退出"><a href="#wq-保存退出" class="headerlink" title="wq!保存退出"></a>wq!保存退出</h3><pre><code>service iptables start #开启systemctl enable iptables.service #设置防火墙开机启动</code></pre><p>##激活演示<br>以管理员权限运行CMD命令提示符<br>输入命令</p><pre><code>slmgr /ipk xxxxxxxxxxxxxxxxxxxx (对应版本的KMS激活密钥 参考下面附录1)slmgr /skms 服务器ip或者域名（如 kms.damowang.cn）slmgr /ato </code></pre><p><img src="http://i.imgur.com/zuRhckU.png" alt=""><br>系统成功激活<br><br><br>附录1：<a href="https://technet.microsoft.com/en-us/library/jj612867.aspx" title="KMS激活密钥对照表" target="_blank" rel="external">https://technet.microsoft.com/en-us/library/jj612867.aspx</a></p><p>激活office<br></p><pre><code>cscript &quot;C:\Program Files (x86)\Microsoft Office\Office14\OSPP.vbs&quot; /sethst: xxxxxx(xxxxxx用kms域名或者ip地址代替)cscript &quot;C:\Program Files (x86)\Microsoft Office\Office14\OSPP.vbs&quot; /ato</code></pre><p>注意激活office必须是VOL版本而不能是Retail版本。如果激活出现错误，注意查看版本，路径是否正确，ip是否正确可用。激活用的密钥是否正确，若提示密钥无效尝试更换office密钥。<br></p><pre><code>cscript ospp.vbs /dstatus</code></pre><p><img src="http://i.imgur.com/5Q2kuD5.png" alt=""></p><p>显示当前已安装产品密钥的许可证信息。可以查看到自已安裝的版本有多少个序列号。</p><pre><code>cscript ospp.vbs /unpkey:xxxxx</code></pre><p><img src="http://i.imgur.com/5TSR9OH.png" alt=""></p><p>卸载已安装的产品密钥。后面的数字是密钥的最后5位数。</p><p>此时再执行cscript ospp.vbs /dstatus发现产品密钥已经没有了，我重新进行导入。</p><pre><code>cscript ospp.vbs /inpkey:xxxxx…… (xxxx代表对应版本的密钥可自己在网上找，也可以在微软官网 )</code></pre><p>安装、替换现有的产品密钥。和上面的过程刚好相反。</p><pre><code>cscript ospp.vbs /sethst:x.x.x.x</code></pre><p>设置KMS主机名。一般为IP地址。</p><pre><code>cscript ospp.vbs /act</code></pre><p>激活当前安装的Office。</p><p>如果office曾经用其它的KMS服务器激活。一定要用</p><pre><code>cscript OSPP.vbs /remhst</code></pre><p>移除kms主机，再执行以上命令 <br>错误排查以及对应KMS KEY 参见附录2<br><br><br>附录2：<a href="https://technet.microsoft.com/zh-cn/library/ee624355(v=office.14).aspx" target="_blank" rel="external">https://technet.microsoft.com/zh-cn/library/ee624355(v=office.14).aspx</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;KMS激活 操作系统 office(VOL)版激活&lt;br&gt;准备：Centos7操作系统，py-kms&lt;br&gt;
    
    </summary>
    
      <category term="know" scheme="http://yoursite.com/categories/know/"/>
    
    
      <category term="pykms" scheme="http://yoursite.com/tags/pykms/"/>
    
  </entry>
  
</feed>
